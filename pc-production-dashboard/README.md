# PC製造専用ダッシュボード v2.2

PC製造部門向けの生産実績ダッシュボード（Embeddable-Python配布用）

## 🆕 最新の更新内容

### v2.2 (2025年1月29日)
- **重複除去機能**: zm29とKANSEI_JISSEKIの重複データを完全除去
- **KANSEI_JISSEKI優先**: 同じ指図番号の場合、KANSEI_JISSEKIを優先選択
- **段階的重複除去**: 完全一致→指図番号の2段階重複除去ロジック
- **テスト機能**: 重複除去機能の動作確認ツール追加

### v2.1 (2025年1月28日)
- **当月+当日重視の設計**: 現在の実績に注力したダッシュボード
- **内製・外注分類**: PC1-3（内製）、PC4-6（外注）の自動分類
- **金額表示改善**: カンマ区切り、単位統一
- **エラー修正**: 更新時刻の型混在エラーを解決

## 🚀 クイックスタート

### 1. データ統合
```cmd
python app/data_loader_simple.py
```

### 2. ダッシュボード起動
```cmd
python app/main.py
```

### 3. バッチファイル起動
```cmd
start_dashboard.bat
```

## 📊 主な機能

- **過去データ統合**: 2024/04-2025/06の月次ZM29データ
- **当日データ統合**: MESからのリアルタイムデータ
- **重複除去機能**: KANSEI_JISSEKIを優先した自動重複除去
- **月別週区分集計**: 月の最初の月曜日基準の週別集計
- **当月+当日重視**: 現在の実績に注力した表示モード
- **内製・外注分類**: PC1-3（内製）、PC4-6（外注）の自動分類
- **インタラクティブダッシュボード**: Streamlit + Plotly
- **CSV出力**: 明細データのダウンロード

## 🔧 技術仕様

- **Python**: 3.11 (Embeddable版対応)
- **フレームワーク**: Streamlit, Plotly
- **データベース**: SQLite
- **データソース**: ZM29月次データ + KANSEI_JISSEKI当日データ

## 📁 ファイル構成

```
pc-production-dashboard/
├── app/
│   ├── main.py                    # エントリーポイント
│   ├── dashboard.py               # Streamlitダッシュボード
│   └── data_loader_simple.py      # データローダー
├── data/
│   ├── current/                   # 当日データ
│   ├── zm29_Monthly_performance/  # 過去データ
│   └── sqlite/                    # SQLiteDB
├── test_deduplication.py          # 重複除去テストツール
├── config.json                    # 設定ファイル
└── start_dashboard.bat            # 起動バッチ
```

## 💰 単価推定システム

品目コードパターンベースの推定単価:
- `P0A`: 5,000円（PCB基板系）
- `P00`: 3,000円（部品系）
- `IK-`: 8,000円（制御基板）
- `PK-`: 6,000円（電源基板）
- `CK-`: 7,000円（制御系）
- `MK-`: 4,000円（その他基板）

## 🎯 配布準備完了

Embeddable-Python環境での配布に対応済み

---

**バージョン**: v1.0  
**作成日**: 2025年1月28日