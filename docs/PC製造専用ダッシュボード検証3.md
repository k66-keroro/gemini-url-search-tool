`"c:\Users\sem3171\claude-test\pc-production-dashboard\analyze_kansei_structure.py"

============================================================

KANSEI_JISSEKI 構造解析

============================================================

📝 検出エンコーディング: SHIFT_JIS (信頼度: 0.99)

📊 基本情報:

行数: 515

カラム数: 16

📋 カラム一覧:

1. プラント

2. 保管場所

3. 品目コード

4. 品目テキスト

5. 指図番号

6. 指図タイプ

7. MRP 管理者

8. 指図数量

9. 実績数量

10. 累計数量

11. 残数量

12. 入力日時

13. 計画終了日

14. WBS 要素

15. 受注伝票番号

16. 受注明細番号

📝 サンプルデータ（最初の 3 行）:

行 1:

1. プラント: P100

2. 保管場所: 1122

3. 品目コード: P0A326100

4. 品目テキスト: PK-3261B  PK-3260 ﾎｶ  SUB

5. 指図番号: 50119749

6. 指図タイプ: ZP11

7. MRP 管理者: PC1

8. 指図数量: 12

9. 実績数量: 12

10. 累計数量: 12

11. 残数量: 0

12. 入力日時: 2025/07/02 08:58

13. 計画終了日: 20250612

14. WBS 要素: nan

15. 受注伝票番号: 0000000000

16. 受注明細番号: 000000

行 2:

1. プラント: P100

2. 保管場所: 1120

3. 品目コード: P00A0795101

4. 品目テキスト: IK-7951 U01 制御 PCB

5. 指図番号: 50119798

6. 指図タイプ: ZP11

7. MRP 管理者: PC1

8. 指図数量: 10

9. 実績数量: 9

10. 累計数量: 9

11. 残数量: 1

12. 入力日時: 2025/07/02 09:10

13. 計画終了日: 20250626

14. WBS 要素: nan

15. 受注伝票番号: 0000000000

16. 受注明細番号: 000000

行 3:

1. プラント: P100

2. 保管場所: 1120

3. 品目コード: P00A0794400

4. 品目テキスト: IK-7944 ﾌｨﾙﾀｺﾝ PCB

5. 指図番号: 50119794

6. 指図タイプ: ZP11

7. MRP 管理者: PC1

8. 指図数量: 10

9. 実績数量: 10

10. 累計数量: 10

11. 残数量: 0

12. 入力日時: 2025/07/02 09:11

13. 計画終了日: 20250626

14. WBS 要素: nan

15. 受注伝票番号: 0000000000

16. 受注明細番号: 000000

🔢 数値データの可能性があるカラム:

✅ 保管場所: 10/10 が数値

サンプル値: ['1122', '1120', '1120', '1120', '1120', '1120', '1120', '1120', '1120', '1120']

✅ 指図番号: 10/10 が数値

サンプル値: ['50119749', '50119798', '50119794', '50119735', '50119902', '50119796', '50119793', '50119658', '50119923', '50119797']

✅ 指図数量: 10/10 が数値

サンプル値: ['12', '10', '10', '3', '4', '20', '10', '1', '1', '10']

✅ 実績数量: 10/10 が数値

サンプル値: ['12', '9', '10', '3', '4', '20', '10', '1', '1', '10']

✅ 累計数量: 10/10 が数値

サンプル値: ['12', '9', '10', '3', '4', '20', '10', '1', '1', '10']

✅ 残数量: 10/10 が数値

サンプル値: ['0', '1', '0', '0', '0', '0', '0', '0', '0', '0']

✅ 計画終了日: 10/10 が数値

サンプル値: ['20250612', '20250626', '20250626', '20250619', '20250626', '20250626', '20250626', '20250626', '20250625', '20250626']

✅ 受注伝票番号: 10/10 が数値

サンプル値: ['0000000000', '0000000000', '0000000000', '0000000000', '0000000000', '0000000000', '0000000000', '0000000000', '0000000000', '0000000000']

✅ 受注明細番号: 10/10 が数値

サンプル値: ['000000', '000000', '000000', '000000', '000000', '000000', '000000', '000000', '000000', '000000']

🔄 ZM29 カラムとの対応関係推測:

転記日付 ← 候補なし

ネットワーク・指図番号 ← ['指図番号', '指図タイプ', '指図数量', '受注伝票番号', '受注明細番号']

品目コード ← ['品目コード', '品目テキスト']

品目テキスト ← ['品目テキスト']

完成数 ← ['指図数量', '実績数量', '累計数量', '残数量']

計画数 ← ['計画終了日']

単価 ← 候補なし

MRP 管理者 ← ['MRP 管理者']

============================================================

正しいカラムマッピング作成

============================================================

推奨マッピング:

転記日付 ← 計画完了日

ネットワーク・指図番号 ← 指図番号

品目コード ← 品目コード

品目テキスト ← 品目テキスト

完成数 ← 完成数

計画数 ← 計画数

単価 ← デフォルト値使用

MRP 管理者 ← MRP 管理者

============================================================

次のステップ

============================================================

1. data_loader_fixed.py のカラムマッピングを修正

2. 単価データがないため、デフォルト値または別ソースから取得

3. 日付フィールドの正しい変換処理を実装

4. 数値フィールドの型変換を確実に実行`
