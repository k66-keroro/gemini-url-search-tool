# SQLite GUI Tool v2.1 - 統合データ処理ツール

## 🎯 プロジェクト概要

既存の手動データ更新処理を自動化・効率化するためのPythonツールです。多様な形式のデータファイルを読み込み、SQLiteデータベースに一括で取り込み、美しいダッシュボードで可視化します。

## ✨ 主要機能

### 📊 Streamlitダッシュボード（NEW!）
- **PC生産実績の可視化**: 既存AccessロジックをStreamlitで完全再現
- **インタラクティブ分析**: リアルタイムフィルタリング・グラフ操作
- **4つの分析画面**: 週別集計・日別集計・明細データ・高度分析
- **ワンクリック起動**: `python run_dashboard.py`

### 🗃️ データベース管理
- **全件データ更新**: data/rawフォルダの全ファイルを自動処理
- **パフォーマンス測定**: 詳細な実行時間分析・ボトルネック特定
- **主キー・インデックス自動設定**: 全テーブルの最適化
- **MARADLパイプライン**: 3段階マスタ処理（MARA_DL → view_pc_master → parsed_pc_master）
- **データ型整合性**: SQLite-Access間の型統一・ゼロパディング対応
- **ZP138特殊処理**: 引当計算付きの個別処理

### 🔧 GUI管理ツール
- **7つの専門タブ**: クエリ実行・スキーマ・インポート・エクスポート・分析・コード変換・DB管理
- **スクリプト実行管理**: 外部スクリプトの統合実行環境
- **エラー耐性**: 堅牢なエラーハンドリングと復旧機能

## 🚀 クイックスタート

### 1. ダッシュボード起動（推奨）
```bash
# PC生産実績ダッシュボードを起動
python run_dashboard.py
```

### 2. GUI管理ツール起動
```bash
# SQLite GUI Tool を起動
python src/core/sqlite_gui_tool_v2_fixed_modular.py
```

### 3. 基本的なワークフロー
1. **データベース接続**: SQLiteファイルを選択
2. **全件データ更新**: data/rawフォルダの全ファイルを処理
3. **ダッシュボード確認**: PC生産実績を可視化
4. **詳細分析**: GUI管理ツールで高度な分析

## 📁 プロジェクト構造

```
claude-test/
├── streamlit_apps/              # Streamlitダッシュボード
│   ├── pc_production_dashboard.py  # PC生産実績ダッシュボード
│   ├── requirements.txt         # 依存パッケージ
│   └── README.md               # ダッシュボード詳細説明
├── src/
│   ├── core/
│   │   ├── sqlite_manager.py   # データベース操作コア
│   │   └── sqlite_gui_tool/    # GUI管理ツール（モジュラー版）
│   │       ├── app.py          # メインアプリケーション
│   │       ├── admin_tab.py    # DB管理（MARADLパイプライン含む）
│   │       ├── launcher_tab.py # スクリプト実行管理
│   │       └── ...             # その他のタブ
│   └── processors/             # 特殊処理スクリプト
│       ├── zp138_processor.py  # ZP138引当計算
│       └── base_processor.py   # 基底クラス
├── data/
│   ├── raw/                    # 入力データファイル
│   │   ├── MARA_DL.csv        # MARAマスタ
│   │   ├── ZM29.txt           # PC生産実績
│   │   └── ...                # その他のデータファイル
│   └── sqlite/                # SQLiteデータベース
│       └── main.db            # メインデータベース
├── docs/                      # プロジェクトドキュメント
│   ├── Streamlitダッシュボード_v1.0.md
│   ├── MARADL統合処理_v2.1.md
│   └── データ型整合性管理_v2.1.md
├── run_dashboard.py           # ダッシュボード実行スクリプト
└── README.md                  # このファイル
```

## 🎨 Streamlitダッシュボード

### 主要機能
- **週別集計**: MRP管理者別の週別生産実績
- **日別集計**: 日別トレンド分析とグラフ表示
- **明細データ**: 詳細検索・フィルタリング・CSV出力
- **高度分析**: 構成比・ランキング・ヒートマップ

### 技術仕様
- **Streamlit**: Webベースの美しいUI
- **Plotly**: インタラクティブなグラフ
- **既存ロジック完全再現**: AccessのVBAロジックをPython化

## 🔄 MARADLパイプライン

### 3段階処理フロー
```
MARA_DL.csv (120フィールド)
    ↓ 全件データ更新
MARA_DL テーブル
    ↓ フィルタ・抽出
view_pc_master テーブル (34フィールド)
    ↓ 差分検出・正規表現解析
parsed_pc_master テーブル (7フィールド)
```

### 正規表現解析
- **派生コード抽出**: `([STU][0-9]{1,2}|[STU][A-Z][0-9])`
- **CM分類コード**: Y_CODE_MAP, HEAD_CM_MAP による自動分類
- **基板番号抽出**: DIMCOM、P00A、P0A形式の自動検出

## 🛠️ データ型整合性管理

### SQLite ↔ Access連携
- **型統一処理**: 品目コード系フィールドを文字列型に統一
- **ゼロパディング**: 10桁固定フォーマット（例: `0001234567`）
- **安全な変換**: エラー耐性のある型変換処理

### 使用方法
```
DB管理タブ → データ型分析 → データ型統一 → Access連携
```

## 📊 サポートファイル形式

### 入力ファイル
- **CSV**: カンマ区切り（UTF-8, CP932対応）
- **TSV**: タブ区切り
- **TXT**: 自動区切り文字検出
- **Excel**: .xlsx, .xls（特殊ヘッダー対応）

### 特殊ファイル対応
- **zm37.txt**: CP932エンコーディング、特殊区切り文字
- **PP_SUMMARY_ZTBP080_KOJOZISSEKI_D_0.xlsx**: ヘッダー7行
- **ZP138.txt**: 引当計算付き特殊処理

## 🔧 技術スタック

### コア技術
- **Python**: 3.8+
- **SQLite**: データベースエンジン
- **Pandas**: データ処理
- **Tkinter**: GUI管理ツール

### ダッシュボード技術
- **Streamlit**: 1.28.0+
- **Plotly**: 5.15.0+
- **NumPy**: 数値計算

### 開発ツール
- **Git**: バージョン管理
- **Kiro IDE**: 統合開発環境

## 📈 パフォーマンス

### 処理速度
- **データ読み込み**: 大容量ファイル対応（チャンク処理）
- **集計処理**: Pandasの最適化されたピボット処理
- **表示速度**: Streamlitキャッシュによる高速表示

### メモリ効率
- **データ型最適化**: 適切な型選択でメモリ使用量削減
- **バッチ処理**: 大量データの分割処理
- **ガベージコレクション**: 適切なメモリ管理

## 🎯 今後の展開

### 短期的改善
- [ ] 月別集計機能の追加
- [ ] 予実対比ダッシュボード
- [ ] アラート・通知機能
- [ ] 自動更新スケジューラー

### 中期的拡張
- [ ] 多言語対応（英語・中国語）
- [ ] モバイル対応
- [ ] ユーザー権限管理
- [ ] カスタムダッシュボード作成

### 長期的展望
- [ ] 機械学習による予測分析
- [ ] リアルタイムデータ連携
- [ ] クラウド展開
- [ ] API連携機能

## 🤝 コントリビューション

### 開発ガイドライン
1. **PEP 8準拠**: Pythonコーディング規約
2. **型ヒント**: 可読性向上のための型注釈
3. **ドキュメント**: 適切なコメントと説明
4. **テスト**: エラーケースの考慮

### ブランチ戦略
- **main**: 安定版（本番環境用）
- **develop**: 開発版（次回リリース用）
- **feature/xxx**: 新機能開発
- **bugfix/xxx**: バグ修正

## 📝 ライセンス

このプロジェクトは内部使用を目的としており、適切なライセンス管理の下で運用されています。

## 🆘 サポート・トラブルシューティング

### よくある問題
1. **データベース接続エラー**: ファイルパスとアクセス権限を確認
2. **メモリ不足**: 大きなファイルは分割処理を検討
3. **文字化け**: エンコーディング設定を確認

### 問い合わせ
- **技術的問題**: 開発チームまでお問い合わせください
- **機能要望**: GitHubのIssueまたは直接連絡

---

**最終更新**: 2025/01/25  
**バージョン**: v2.1  
**開発者**: SQLite GUI Tool Development Team